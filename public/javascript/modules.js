var $__cart_47_init_46_js__=function(){"use strict";return{}}(),$__cart_47_item_46_js__=function(){"use strict";return function(t,e,i){e.define("pageCartItem",["basePubSub","extend"],function(t,e,n){var s=n(e),o=s,r=o.superclass;BM.tools.mixin(o.prototype,{initialize:function(t){r.initialize.apply(this,arguments),this.$elem=t.element,this.$elemButtonRemove=this.$elem.find("@b-cart-item-button-remove"),this.$elemButtonMinus=this.$elem.find("@b-cart-item-button-minus"),this.$elemButtonPlus=this.$elem.find("@b-cart-item-button-plus"),this.$elemAmount=this.$elem.find("@b-cart-item-amount"),this.$elemPrice=this.$elem.find("@b-cart-item-price"),this.$elemPriceTotal=this.$elem.find("@b-cart-item-price-total"),this._config={item:{id:null}},this._parseConfig(),this._updateLayout(),this._setupEvents()},_parseConfig:function(){try{this._config=JSON.parse(this.$elem.attr("data-config"))}catch(t){}},_setupEvents:function(){var t=this;this.$elemButtonRemove.on("click",function(){t._onButtonCloseClick()}),this.$elemButtonMinus.on("click",function(){t._onButtonMinusClick()}),this.$elemButtonPlus.on("click",function(){t._onButtonPlusClick()})},_onButtonCloseClick:function(){var t=this;this._setStateWait(!0),i.ajax({url:"/api/cart/item/remove",type:"post",dataType:"json",data:{item:{id:this._config.item.id}},success:function(e){setTimeout(function(){t._onRequestItemRemoveSuccess(e)},300)},error:function(){setTimeout(function(){t._onRequestAddToCartError()},300)}})},_onButtonMinusClick:function(){this._getCurrentAmount()>1&&this._sendRequestDecItem()},_sendRequestDecItem:function(){var t=this;i.ajax({url:"/api/cart/item/dec",type:"post",dataType:"json",data:{item:{id:this._config.item.id}},success:function(e){setTimeout(function(){t._onRequestDecItemSuccess(),radio("b-cart-update").broadcast(e)},300)},error:function(){t._onRequestDecItemError()}})},_onRequestDecItemSuccess:function(){this._setStateWait(!1),this._decItemAmount(),this._updatePrice()},_onRequestDecItemError:function(){this._setStateWait(!1)},_onButtonPlusClick:function(){this._sendRequestIncItem()},_sendRequestIncItem:function(){var t=this;i.ajax({url:"/api/cart/item/inc",type:"post",dataType:"json",data:{item:{id:this._config.item.id}},success:function(e){setTimeout(function(){t._onRequestIncItemSuccess(e)},300)},error:function(){t._onRequestIncItemError()}})},_onRequestIncItemSuccess:function(t){this._setStateWait(!1),this._incItemAmount(),this._updatePrice(),radio("b-cart-update").broadcast(t)},_onRequestIncItemError:function(){this._setStateWait(!1)},_onRequestItemRemoveSuccess:function(t){var e=this;setTimeout(function(){e.hide(),radio("b-cart-update").broadcast(t)}.bind(this),300)},_onRequestItemRemoveError:function(){setTimeout(function(){this._setStateWait(!1)}.bind(this),300)},_slideOut:function(){},hide:function(){this.$elem.attr("data-visible","false")},_updateLayout:function(){},_setStateWait:function(t){t?this.$elem.attr("data-wait","true"):this.$elem.attr("data-wait","fasle")},_getCurrentAmount:function(){var t=this.$elemAmount.html();return t=parseInt(t,10)},_incItemAmount:function(){var t=this._getCurrentAmount();return this._showButtonMinus(),this.$elemAmount.html(t+1)},_decItemAmount:function(){var t=this._getCurrentAmount();return 2>=t&&this._hideButtonMinus(),this.$elemAmount.html(t-1)},_showButtonMinus:function(){this.$elemButtonMinus.attr("data-visible","true")},_hideButtonMinus:function(){this.$elemButtonMinus.attr("data-visible","false")},_updatePrice:function(){var t=this._getCurrentAmount();t>1?this._showPriceTotal():this._hidePriceTotal()},_showPriceTotal:function(){this.$elemPriceTotal.html(this._getCurrentAmount()*this._config.item.price),this.$elemPrice.attr("data-total-visible","true")},_hidePriceTotal:function(){this.$elemPrice.attr("data-total-visible","false")},destroy:function(){r.destroy.apply(this,arguments)}}),t(s)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__catalogue_47_init_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueInit",["extend","baseView","CatalogueMenu","CatalogueItem"],function(e,s,o,r,a){{var l=s(o),u=l,c=u.superclass;i(t)}n.tools.mixin(u.prototype,{initialize:function(){c.initialize.apply(this,arguments),this.$elem&&(this.$menu=this.$elem.find("@bm-page-catalogue-menu"),this.$itemsWrapper=this.$elem.find("@bm-catalogue-items-wrapper"),this.$itemsGridWrapper=this.$elem.find("@bm-catalogue-items-grid"),this.$items=this.$itemsGridWrapper.find("@bm-catalogue-item"),this.$itemsSpecialWrapper=this.$elem.find("@bm-catalogue-items-special"),this.$itemsSpecial=this.$itemsSpecialWrapper.find("@bm-catalogue-item"),this._menu=null,this._items=[],this._initMenu(),this._initItems(),this._updateItems(),this._bindEvents(),this._items[0]._showPopup())},_bindEvents:function(){},_initItems:function(){var t=this;this.$items.each(function(){var e=new a({element:i(this)});t._items.push(e)})},_initMenu:function(){n.tools.isNull(this._menu)&&(this._menu=new r({element:this.$menu}),this._menu.on("category-selected",function(t,e){e?this.el.attr("data-special",e):(this.el.removeAttr("data-special"),this.$itemsGridWrapper.attr("data-selected-category",t),n.helper.browser.triggerRerender(),this._updateItems())}.bind(this)))},_updateItems:function(){if(!n.tools.client.isTouch()){var t=this;this.$items.filter(":visible").each(function(e){var i=t._getItemHandler(this);n.tools.isNull(i)||((e+1)%4===0?i.dockMoreToRight():i.dockMoreToLeft())})}},_getItemHandler:function(t){return this._items.filter(function(e){return e.el.get(0)===t})[0]||null}}),new l({element:i(document.body).find("@bm-page-catalogue")}),e(l)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_47_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueItem",["extend","baseView","PopupItem"],function(e,s,o,r){var a=s(o),l=a,u=l.superclass,c=(i(t),70),m={fr:1,to:.1};n.tools.mixin(l.prototype,{initialize:function(){u.initialize.apply(this,arguments),this.el&&(this._config={},this.$content=this.el.find("@bm-catalogue-item-content"),this.$moreInfo=this.el.find("@bm-catalogue-item-more-info"),this._offset=null,this._contentWidth=null,this._widthWithMore=null,this._parseConfig(),this._bindEvents())},_bindEvents:function(){this.el.on(n.helper.event.clickName(),function(){this._onClick()}.bind(this)),this.el.on("mouseover",function(t){this._onMouseOver(t)}.bind(this)),this.el.on("mouseout",function(t){this._onMouseOut(t)}.bind(this)),this.el.on("mousemove",function(t){this._onMouseMove(t)}.bind(this))},_onClick:function(){this._showPopup()},_onMouseOver:function(){this._isMoreVisible()||(this._setMoreInfoVisible(!0),n.helper.browser.triggerRerender())},_onMouseOut:function(){this._setMoreInfoVisible(!1)},_onMouseMove:function(t){this._updateElementOffset(),this._updateContentWidth(),this._updateWidthWithMore();var e=t.pageX-this._offset.left,i=m,s=i.fr-i.to;if(this._isMoreDockedToLeft()){var o=this._contentWidth,r=this._contentWidth+c;if(e>r)this._setMoreInfoVisible(!1);else if(e>o&&r>e){var a=e-this._contentWidth,l=a/c,u=i.to+s*(1-l);this._setMoreOpacity(u)}}else if(this._isMoreDockedToRight()&&!n.tools.isNull(this._widthWithMore)&&0>=e){var r=c,a=Math.abs(e);if(a>r)this._setMoreInfoVisible(!1);else{var l=a/c,u=i.to+s*(1-l);this._setMoreOpacity(u)}}},_showPopup:function(){n.tools.isNull(this._popup)&&(this._popup=new r({data:this._config})),this._popup.show()},_updateElementOffset:function(){n.tools.isNull(this._offset)&&(this._offset=this.el.offset())},_updateContentWidth:function(){n.tools.isNull(this._contentWidth)&&(this._contentWidth=this.$content.width())},_updateWidthWithMore:function(){n.tools.isNull(this._widthWithMore)&&this.el.hasClass("m-dock-more-to-right")&&(this._widthWithMore=this.el.width())},_setMoreInfoVisible:function(t){t?this.el.addClass("m-more-info-visible")&&this._setMoreOpacity(1):this.el.removeClass("m-more-info-visible")},_setMoreOpacity:function(t){t=Math.min(1,Math.max(0,t)),this.$moreInfo.css({opacity:t})},_isMoreDockedToLeft:function(){return!this.el.hasClass("m-dock-more-to-right")},_isMoreDockedToRight:function(){return this.el.hasClass("m-dock-more-to-right")},_isMoreVisible:function(){return this.el.hasClass("m-more-info-visible")},dockMoreToRight:function(){this.el.addClass("m-dock-more-to-right")},dockMoreToLeft:function(){this.el.removeClass("m-dock-more-to-right")}}),e(a)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_47_menu_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueMenu",["extend","baseView"],function(e,s,o){{var r=s(o),a=r,l=a.superclass;i(t)}n.tools.mixin(a.prototype,{initialize:function(){l.initialize.apply(this,arguments),this.el&&(this.$list=this.$elem.find("@bm-page-catalogue-list"),this.$select=this.$elem.find("@bm-page-catalogue-select"),this.$listItems=this.$list.find("@bm-page-catalogue-menu-item"),this.$selectItems=this.$select.find("@bm-page-catalogue-menu-select-item"),this.$selectDropdownButton=this.el.find("@bm-page-catalogue-menu-select-dropdown-button"),this.$selectCurrentItemWrapper=this.el.find("@bm-page-catalogue-menu-select-current-item-wrapper"),this._offset=null,this._selectItemHeight=null,this._updateSelect(),this._bindEvents())},_bindEvents:function(){var t=this,e=n.helper.event.clickName();this.$selectItems.on(e,function(e){t._onSelectItemClick(e,this)}),this.$listItems.on(e,function(t){this._onListItemClick(t)}.bind(this))},_updateSelect:function(){this._updateMenuOffset(),this._updateSelectItemHeight(),this._updateItemsPosition()},_updateItemsPosition:function(){var t=this;this.$selectItems.each(function(e){if(!(1>e)){var n=i(this);console.log(),n.css({transform:"translateY("+t._selectItemHeight*e+"px)"})}})},_updateMenuOffset:function(){return n.tools.isNull(this._offset)?void(this._offset=this.el.offset()):void(this._updateMenuOffset=function(){})},_updateSelectItemHeight:function(){return n.tools.isNull(this._selectItemHeight)?void(this._selectItemHeight=this._getSelectedSelectItem().height()):void(this._updateSelectItemHeight=function(){})},_getSelectedSelectItem:function(){return this.$selectItems.filter(function(){return i(this).hasClass("m-selected")})},_updateSelectItemWrapper:function(){this.$selectItems.each(function(){var t=i(this),e=t.find("@bm-page-catalogue-menu-item");e.hasClass("m-selected")?t.addClass("m-selected"):t.removeClass("m-selected")})},_onSelectItemClick:function(t,e){if(e=i(e),e.hasClass("m-selected"))this._toggleMenu();else{this.$selectItems.removeClass("m-selected"),e.addClass("m-selected"),this._toggleMenu();var n=e.find("@bm-page-catalogue-menu-item");this._notify("category-selected",n.data("name"),n.data("special"))}},_toggleMenu:function(){this._isSelectExpanded()?this._collapseSelect():this._expandSelect()},_isSelectExpanded:function(){return this.el.hasClass("m-select-expanded")},_expandSelect:function(){this.el.addClass("m-select-expanded")},_collapseSelect:function(){this.el.removeClass("m-select-expanded")},_onListItemClick:function(t){var e=i(t.target),s=e.data("name");n.tools.isNull(e.data("name"))&&(e=e.parent(".bm-page-catalogue-menu-item"),s=e.name),this.$listItems.removeClass("m-selected"),e.addClass("m-selected"),this._notify("category-selected",e.data("name"),e.data("special"))}}),e(r)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_95_old_47_background_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueBackground",["extend","baseView","EventDispatcher"],function(e,s,o,r){{var a=s(o),l=a,u=l.superclass;i(t)}n.tools.mixin(l.prototype,{initialize:function(){u.initialize.apply(this,arguments),this.$elem&&(this._items={mono:this._getItem("mono"),aroma:this._getItem("aroma")},this._itemsArr=[this._items.mono,this._items.aroma],this._baseHeight=null,this._currentItem=this._items.mono,this._lastOffsetValue=null,this._updateFull(),this._bindEvents(),setTimeout(function(){this._updateFull()}.bind(this),300))},_getItem:function(t){var e=this.$elem.find("[data-item="+t+"]");return{elem:e,size:e.data("size"),height:e.height(),aspect:parseFloat(e.data("aspect"))}},_bindEvents:function(){r.on("window-resize",function(){this._updateFull()}.bind(this))},setCurrentItem:function(t){if(t!==this._currentItem.elem.data("item")){var e=this._getItem(t);e.elem.length<1||(e.elem.prependTo(this.$elem),e.elem.addClass("m-visible"),this._currentItem.elem.removeClass("m-visible"),this._currentItem=e,this._notify("update",e.elem.data("item")))}},_getCurrentItem:function(){},setProgress:function(t){n.tools.isNumber(t)&&(t=Math.min(100,Math.max(0,t)),this._setCurrentItemOffset(t))},_updateFull:function(){this._updateOrientation(),this._updateBaseHeightValue(),this._updateCurrentItemOffset()},_setCurrentItemOffset:function(e){this._lastOffsetValue=e;var i=(this._currentItem.height-this._baseHeight)/100*e*-1;t.requestAnimationFrame(function(){this._currentItem.elem.css({transform:"translateY("+i+"px)"})}.bind(this))},_updateOrientation:function(){var e=t.innerWidth/t.innerHeight;this._itemsArr.forEach(function(t){t.aspect>=e?t.elem.addClass("m-orientation-inverted"):t.elem.removeClass("m-orientation-inverted")})},_updateBaseHeightValue:function(){this._baseHeight=this.$elem.height()},_updateCurrentItemOffset:function(){n.tools.isNull(this._lastOffsetValue)||this._setCurrentItemOffset(this._lastOffsetValue)}}),e(a)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_95_old_47_init_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueInitOld",["extend","baseView","CatalogueBackground","CatalogueMenu","CatalogueItem","EventDispatcher"],function(e,s,o,r,a,l,u){var c=s(o),m=c,h=m.superclass,d=i(t);n.tools.mixin(m.prototype,{initialize:function(){h.initialize.apply(this,arguments),this.$elem&&(this._backgroundHandler=null,this._menuHandler=null,this.$elemBackground=this.$elem.find("@bm-catalogue-background"),this.$elemMenu=this.$elem.find("@bm-catalogue-menu"),this.$elemItemsWrapper=this.$elem.find("@bm-catalogue-items-wrapper"),this._groupes=[this.$elemGroupClassic=this.$elem.find("@bm-catalogue-item-group-classic"),this.$elemGroupAroma=this.$elem.find("@bm-catalogue-item-group-aroma")],this._groupesRanges=[],this._initItems())},_bindEvents:function(){u.on("window-resize",function(){this._saveGroupsRanges()}.bind(this))},_initBackground:function(){n.tools.isNull(this._backgroundHandler)&&(this._backgroundHandler=new r({element:this.$elemBackground}),this._backgroundHandler.on("update",function(t){this._onBackgroundUpdate(t)}.bind(this)),u.on("window-scroll",function(){this._updateBackground()}.bind(this)))},_initMenu:function(){n.tools.isNull(this._menuHandler)&&(this._menuHandler=new a({element:this.$elemMenu}))},_onBackgroundUpdate:function(t){n.tools.isNull(this._menuHandler)||this._menuHandler.focusItem(t)},_initItems:function(){var t;this.$elemItemsWrapper.each(function(){i(this).find("@bm-catalogue-item").each(function(){t=new l({element:i(this)})})})},_saveGroupsRanges:function(){var t=0;this._groupesRanges.length=0,this._groupesRanges=[],this._groupes.forEach(function(e){var i=e.offset().top+e.height();this._groupesRanges.push({elem:e,height:e.height(),top:t,bottom:i}),t=i+1}.bind(this))},_updateBackground:function(){var t=this._getCurrentRange();n.tools.isNull(t)||(this._updateParallax(t),this._updateImage(t.elem))},_updateParallax:function(t){var e=d.scrollTop(),i=parseInt(((e-t.top)/(t.bottom-t.top)*100).toFixed(0),10);n.tools.isNull(this._backgroundHandler)||this._backgroundHandler.setProgress(i)},_updateImage:function(t){n.tools.isNull(this._backgroundHandler)||this._backgroundHandler.setCurrentItem(t.data("name"))},_getCurrentGroupByRange:function(){var t=this._getCurrentRange();return n.tools.isNull(t)?void 0:t.elem},_getCurrentRange:function(){var e,i,n=d.scrollTop()+t.innerHeight/2,s=this._groupesRanges.length;for(i=0;s>i;++i)if(e=this._groupesRanges[i],n>=e.top&&n<=e.bottom)return e;return null}}),new c({element:i(document.body).find("@bm-catalogue-index")}),e(c)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_95_old_47_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueItemOld",["extend","baseView","PopupItem"],function(t,e,i,s){var o=e(i),r=o,a=r.superclass;n.tools.mixin(r.prototype,{initialize:function(){a.initialize.apply(this,arguments),this.$elem&&(this._popupHandler=null,this._bindEvents())},_bindEvents:function(){this.$elem.on(n.helper.event.clickName(),function(t){this._onClick(t)}.bind(this))},_onClick:function(){this.showPopup()},_initPopup:function(){n.tools.isNull(this._popupHandler)&&(this._popupHandler=new s)},showPopup:function(){this._initPopup(),this._popupHandler.show()}}),t(o)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__catalogue_95_old_47_menu_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CatalogueMenuOld",["extend","baseView","EventDispatcher"],function(e,s,o,r){var a=s(o),l=a,u=l.superclass,c=i(t);n.tools.mixin(l.prototype,{initialize:function(){u.initialize.apply(this,arguments),this.$elem&&(this.$elemsItems=this.$elem.find("@bm-catalogue-menu-item"),this._offsetTop=this.$elem.offset().top,this._bindEvents())},_bindEvents:function(){r.on("window-scroll",function(){this._updatePosition()}.bind(this))},_updatePosition:function(){c.scrollTop()>=this._offsetTop?this.$elem.addClass("m-fixed"):this.$elem.removeClass("m-fixed")},focusItem:function(t){var e=this.$elemsItems.filter("[data-item="+t+"]");e.length>0&&(this.$elemsItems.removeClass("m-focused"),e.addClass("m-focused"))}}),e(a)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__mvc_47_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ItemModel",["extend","Model"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(){r.initialize.apply(this,arguments)},getPrice:function(){return this._getPrice(250)},getPrice250:function(){return this.getPrice()},getPrice500:function(){return this._getPrice(500)},getPrice1000:function(){return this._getPrice(1e3)},_getPrice:function(t){var e=null;return this._data.price.forEach(function(i){i.amount===t&&(e=i)}),e.value}}),n.tools.mixin(o.prototype,{}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__order_47_order_45_init_46_js__=function(){"use strict";return function(t,e,i,n){e.define("OrderInit",["extend","baseView","PageOrder","CartStore"],function(e,s,o,r,a){{var l=s(o),u=l,c=u.superclass;i(t)}n.tools.mixin(u.prototype,{initialize:function(){c.initialize.apply(this,arguments),this.el&&(this._renderReact(),this._bindEvents())},_bindEvents:function(){var t=this;a.addChangeListener(function(){t._onCartStoreChange()})},_onCartStoreChange:function(){var e=a.getCart();e&&_.isArray(e.order_items)&&0===e.order_items.length&&(t.location.href=n.helper.link.root())},_renderReact:function(){React.render(React.createElement(r,null),this.el.get(0))}}),new l({element:i(document.body).find("@bm-page-order-wrapper")}),e(l)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__react_47_flux_46_js__=function(){"use strict";return function(t,e){var i;e.define("Flux",[],function(t){return i?void t(i):(i=new McFly,void t(i))})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_init_46_js__=function(){"use strict";return function(t,e,i){e.define("beforeUIModulesInit",["InitGlobalStylesModifiers","InitEventDispatcher","ReactSetup","CartInit","ClientDataInit"],function(t){t()}),e.define("ui-modules",["beforeUIModulesInit","initTransformOriginDependentElements","SideMenuInit","HeaderInit"],function(t){i("body").addClass(BM.tools.client.isTouch()?"m-touch":"m-desktop"),t()})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_actions_47_CartActions_46_js__=function(){"use strict";return function(t,e){var i;e.define("CartActions",["Flux","CartConstants"],function(t,e,n){return i?void t(i):(i=e.createActions({loadCart:function(){return{actionType:n.LOADCART}},addItem:function(t,e,i){return{actionType:n.ADDITEM,itemId:t,weight:e,grind:i}},removeItem:function(t,e,i){return{actionType:n.REMOVEITEM,itemId:t,weight:e,grind:i}},deleteItem:function(t,e,i){return{actionType:n.DELETEITEM,itemId:t,weight:e,grind:i}}}),void t(i))})}(this,this.modules),{}}.call(Reflect.global),$__react_47_actions_47_OrderActions_46_js__=function(){"use strict";return function(t,e){var i;e.define("OrderActions",["Flux","OrderConstants"],function(t,e,n){return i?void t(i):(i=e.createActions({setSummaryViewMode:function(t){return{actionType:n.SETSUMMARYVIEWMODE,mode:t}},toggleSummaryViewMode:function(){return{actionType:n.TOGGLESUMMARYVIEWMODE}}}),void t(i))})}(this,this.modules),{}}.call(Reflect.global),$__react_47_actions_47_StateActions_46_js__=function(){"use strict";return function(t,e){var i;e.define("StateActions",["Flux","StateConstants"],function(t,e,n){return i?void t(i):(i=e.createActions({setViewingItem:function(t){return{actionType:n.SETVIEWINGITEM,item:t}}}),void t(i))})}(this,this.modules),{}}.call(Reflect.global),$__react_47_components_47_AddedItem_46_js__=function(){"use strict";return function(t,e){e.define("ItemAddedItem",["CartActions"],function(t,e){var i=React.createClass({displayName:"ItemAddedItem",propTypes:{orderItem:React.PropTypes.object},handleAddItemClick:function(){e.addItem(this.props.item.id,this.props.weight,this.props.grind)},handleRemoveItemClick:function(){e.removeItem(this.props.item.id,this.props.weight,this.props.grind)},handleDeleteItemClick:function(){e.deleteItem(this.props.item.id,this.props.weight,this.props.grind)},getTotalPrice:function(){var t;return 250===this.props.weight?t=this.props.item.price:500===this.props.weight?t=this.props.item.price_500:1e3===this.props.weight&&(t=this.props.item.price_1000),t*this.props.quantity},getGrindText:function(){var t=BM.helper.grind.getTypeMeta(this.props.grind);return t.label_full.toLowerCase()},getPackInPlural:function(){return BM.helper.pluralize.getWordPack(this.props.quantity)},render:function(){return React.createElement("div",{className:"bm-item-form-order-added-item"},React.createElement("div",{className:"bm-item-form-order-added-item-content"},React.createElement("div",{className:"bm-item-form-order-added-item-text"},this.props.quantity," ",this.getPackInPlural()," «Никарагуа» ",this.props.weight," грамм, ",this.getGrindText(),React.createElement("span",{className:"bm-item-form-order-added-item-text-price"},", 150 рублей")),React.createElement("div",{className:"buttons-wrapper"},React.createElement("div",{className:"button m-minus",onClick:this.handleRemoveItemClick}),React.createElement("div",{className:"button m-plus",onClick:this.handleAddItemClick}),React.createElement("div",{className:"button m-remove",onClick:this.handleDeleteItemClick}))),React.createElement("div",{className:"bm-item-form-order-added-item-aside"},React.createElement("div",{className:"bm-item-form-order-added-item-aside-label"},this.getTotalPrice()," рублей")))}});t(i)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_components_47_AddedItems_46_js__=function(){"use strict";return function(t,e){e.define("ItemAddedItems",["ItemAddedItem","CartStore","StateStore"],function(t,e,i,n){function s(){return{cart:i.getCart(),viewingItem:n.getViewingItem()}}var o=React.createClass({displayName:"AddedItems",mixins:[i.mixin],getInitialState:function(){return s()},storeDidChange:function(){this.setState(s())},render:function(){var t=this,i=this.state.cart,n=i&&i.order_items,s=["bm-item-form-order-added-items"];_.isArray(n)&&0===n.length&&s.push("m-empty");var o;return _.isArray(n)&&this.state.viewingItem&&(o=_.filter(n,function(e){return e.item.id===t.state.viewingItem.id})),React.createElement("div",{className:s.join(" ")},o?o.map(function(t){return React.createElement(e,React.__spread({key:t.id},t))}):null)}});t(o)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_components_47_PageOrder_46_js__=function(){"use strict";return function(t,e){e.define("PageOrder",["CartActions","CartStore","OrderActions","OrderStore","OrderConstants","OrderSummarySimple","OrderSummaryTable"],function(t,e,i,n,s,o,r,a){function l(){return{cart:i.getCart(),summaryView:s.summaryView()}}var u=React.createClass({displayName:"PageOrder",mixins:[i.mixin,s.mixin],getInitialState:function(){return l()},storeDidChange:function(){this.setState(l())},onSummaryViewToggleClick:function(){n.toggleSummaryViewMode()},isSummaryViewModeSimple:function(){return this.state.summaryView===o.SUMMARY_VIEW_MODE_SIMPLE},render:function(){if(!this.state.cart)return null;var t=this.state.cart,e=[{label:"Итого за кофе:",value:t.amount+" руб."}];return _.isNumber(t.discount)&&t.discount>0&&(e.push({label:"Скидка:",value:t.discount+"%"}),e.push({label:"Итого со скидкой:",value:t.total_amount+" руб."})),React.createElement("div",{className:"bm-page-order"},React.createElement("div",{className:"bm-page-order-content"},React.createElement("div",{className:"bm-page-order-header m-offset-30"},"Ваш заказ",React.createElement("span",{className:"bm-page-order-header-aside"},React.createElement("span",{className:"bm-page-order-summary-view-toggle",onClick:this.onSummaryViewToggleClick},this.isSummaryViewModeSimple()?"в виде таблицы":"списком"))),this.isSummaryViewModeSimple()?React.createElement(r,{cart:t}):React.createElement(a,{cart:t}),React.createElement("div",{className:"bm-page-order-summary-total"},e.map(function(t){return React.createElement("div",{className:"bm-page-order-summary-total-row"},React.createElement("div",{className:"bm-page-order-summary-total-label"},t.label),React.createElement("div",{className:"bm-page-order-summary-total-value"},t.value))}))))}});t(u)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_constants_47_CartConstants_46_js__=function(){"use strict";return function(t,e){var i;e.define("CartConstants",[],function(t){return i?void t(i):(i={LOADCART:"LOAD CART",ADDITEM:"ADD ITEM",REMOVEITEM:"REMOVE ITEM",DELETEITEM:"DELETE ITEM"},void t(i))})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_constants_47_OrderConstants_46_js__=function(){"use strict";return function(t,e){var i;e.define("OrderConstants",[],function(t){return i?void t(i):(i={SETSUMMARYVIEWMODE:"SET SUMMARY VIEW MODE",TOGGLESUMMARYVIEWMODE:"TOGGLE SUMMARY VIEW MODE",SUMMARY_VIEW_MODE_SIMPLE:"SUMMARY_VIEW_MODE_SIMPLE",SUMMARY_VIEW_MODE_TABLE:"SUMMARY_VIEW_MODE_TABLE"},void t(i))})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_constants_47_StateConstants_46_js__=function(){"use strict";return function(t,e){var i;e.define("StateConstants",[],function(t){return i?void t(i):(i={SETVIEWINGITEM:"SET VIEWING ITEM"},void t(i))})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_stores_47_CartStore_46_js__=function(){"use strict";return function(t,e,i){var n;e.define("CartStore",["Flux","CartConstants"],function(t,e,s){function o(t){c=t,n.emitChange()}function r(){i.ajax({type:"get",url:"/api/cart/get",success:function(t){o(t)},error:function(){}})}function a(t,e,n){i.ajax({type:"post",url:"/api/cart/add_item",data:{item_id:t,weight:e,grind:n},success:function(t){o(t)},error:function(){}})}function l(t,e,n){i.ajax({type:"post",url:"/api/cart/remove_item",data:{item_id:t,weight:e,grind:n},success:function(t){o(t)},error:function(){}})}function u(t,e,n){i.ajax({type:"post",url:"/api/cart/delete_item",data:{item_id:t,weight:e,grind:n},success:function(t){o(t)},error:function(){}})}if(n)return void t(n);var c=null;n=e.createStore({getCart:function(){return c}},function(t){switch(t.actionType){case s.LOADCART:r();break;case s.ADDITEM:a(t.itemId,t.weight,t.grind);break;case s.REMOVEITEM:l(t.itemId,t.weight,t.grind);break;case s.DELETEITEM:u(t.itemId,t.weight,t.grind)}}),t(n)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_stores_47_OrderStore_46_js__=function(){"use strict";return function(t,e){var i;e.define("OrderStore",["Flux","OrderConstants"],function(t,e,n){function s(){localforage.getItem("orderStore").then(function(t){t&&t._summaryViewMode&&(l=t._summaryViewMode),i&&i.emitChange()})}function o(){localforage.setItem("orderStore",{_summaryViewMode:l})}function r(t){l=t,o()}function a(){l=l===n.SUMMARY_VIEW_MODE_TABLE?n.SUMMARY_VIEW_MODE_SIMPLE:n.SUMMARY_VIEW_MODE_TABLE,i.emitChange(),o()}if(i)return void t(i);var l=n.SUMMARY_VIEW_MODE_SIMPLE;s(),i=e.createStore({summaryView:function(){return l}},function(t){switch(t.actionType){case n.SETSUMMARYVIEWMODE:r(t.mode);break;case n.TOGGLESUMMARYVIEWMODE:a()}}),t(i)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_stores_47_StateStore_46_js__=function(){"use strict";return function(t,e){var i;e.define("StateStore",["Flux","StateConstants"],function(t,e,n){function s(t){o=t}if(i)return void t(i);var o;i=e.createStore({getViewingItem:function(){return o}},function(t){switch(t.actionType){case n.SETVIEWINGITEM:s(t.item)}}),t(i)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_cart_47_cart_45_header_46_js__=function(){"use strict";return function(t,e,i,n){e.define("HeaderCart",["basePubSub","extend","CartProcessor"],function(t,e,i,s){var o=i(e),r=o,a=r.superclass;n.tools.mixin(r.prototype,{initialize:function(t){a.initialize.apply(this,arguments),t&&t.element&&(this.$elem=t.element,this.$elemCounter=this.$elem.find("@b-header-cart-counter"),this.$elemCounterText=this.$elem.find("@b-header-cart-counter-text"),this.$elemButtonOrder=this.$elem.find("@b-header-cart-button-order"),this._setupEvents(),this._updateData())},_setupEvents:function(){var t=this;s.on("update",function(){t._updateData()})},_showCounter:function(){this.$elemCounter.attr("data-visible","true")},_hideCounter:function(){this.$elemCounter.attr("data-visible","false")},_updateData:function(){this._updateDataCounter()},_updateDataCounter:function(){var t=s.getTotalItems();1>t?(this._hideCounter(),this._hideButtonOrder()):(this._updateCounterText(),this._showCounter(),this._showButtonOrder())},_showButtonOrder:function(){this.$elemButtonOrder.attr("data-visible","true")},_hideButtonOrder:function(){this.$elemButtonOrder.attr("data-visible","false")},_updateCounterText:function(){var t=s.getTotalItems();this.$elemCounterText.html(t)},destroy:function(){a.destroy.apply(this,arguments)}}),t(o)}),e.define("initCartHeader",["HeaderCart"],function(t,e){new e({element:i("@b-header-cart")});t()})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_cart_47_cart_45_processor_46_js__=function(){"use strict";return function(t,e,i,n){e.define("CartProcessorClass",["basePubSub","extend"],function(t,e,i){var n=i(e),s=n,o=s.superclass;BM.tools.mixin(s.prototype,{initialize:function(){o.initialize.apply(this,arguments),this._data={items:[]}},setData:function(t){if(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}this._data=t,this._notify("update")}},getData:function(){return this._data},getTotalItems:function(){var t=0;return this._data.items.forEach(function(e){t+=e.amount}),t},destroy:function(){o.destroy.apply(this,arguments)}}),t(n)}),e.define("CartProcessor",["CartProcessorClass"],function(t,e){var n=i(document.body),s=new e;try{s.setData(JSON.parse(n.attr("data-cart-config")))}catch(o){}t(s)}),e.define("initCartProcessor",["CartProcessor"],function(t,e){n("b-cart-update").subscribe(function(t){e.setData(t)}),t()})}(this,this.modules,this.jQuery,this.radio),{}}.call(Reflect.global),$__ui_45_modules_47_controls_47_button_45_number_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ButtonNumber",["extend","baseView"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(){r.initialize.apply(this,arguments),this.$elem&&(this._value=0,this.$elemInputValue=this.$elem.find("@bm-button-number-input-value"),this.$elemMinus=this.$elem.find("@bm-button-number-minus"),this.$elemPlus=this.$elem.find("@bm-button-number-plus"),this.$elemValue=this.$elem.find("@bm-button-number-value"),this._bindEvents(),this.update())
},_bindEvents:function(){this.$elemMinus.on(n.helper.event.clickName(),function(t){this._onMinusClick(t)}.bind(this)),this.$elemPlus.on(n.helper.event.clickName(),function(t){this._onPlusClick(t)}.bind(this))},_onMinusClick:function(){this._decValue()},_onPlusClick:function(){this._incValue()},_incValue:function(){this.setValue(this._value+1)},_decValue:function(){this.setValue(Math.max(0,this._value-1))},setValue:function(t){n.tools.isNumber(t)&&t>=0&&(this._value=t,this.update(),this._notify("change",this._value))},update:function(){this._value<1?(this.$elem.removeClass("m-value-present"),this.$elemMinus.addClass("m-disabled")):(this.$elem.addClass("m-value-present"),this.$elemValue.html(this._value),this.$elemMinus.removeClass("m-disabled"))}}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_dispatcher_47_dispatcher_46_js__=function(){"use strict";return function(t,e,i,n){var s=null;e.define("EventDispatcherConstructor",["extend","basePubSub"],function(e,s,o){var r=s(o),a=r,l=a.superclass,u=i(t);n.tools.mixin(a.prototype,{initialize:function(){l.initialize.apply(this,arguments),this._timeoutNotifyResize=null,this._bindEvents()},_bindEvents:function(){u.one("resize",function t(){n.tools.isNull(this._timeoutNotifyResize)||(clearTimeout(this._timeoutNotifyResize),this._timeoutNotifyResize=null),this._timeoutNotifyResize=setTimeout(function(){this._notify("window-resize")}.bind(this),200),setTimeout(function(){u.one("resize",t.bind(this))}.bind(this),50)}.bind(this)),u.one("scroll",function e(){this._notify("window-scroll"),setTimeout(function(){u.one("scroll",e.bind(this))}.bind(this),25)}.bind(this))}}),e(r)}),e.define("InitEventDispatcher",["EventDispatcherConstructor"],function(t,e){s=new e,t()}),e.define("EventDispatcher",[],function(t){t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_dynamic_45_content_47_dynamic_45_content_46_js__=function(){"use strict";return function(t,e,i,n,s){var o=function(t,e,n){var s=e(n),o=s,r=o.superclass,a={FADE:1,SLIDE:2};i.tools.mixin(o.prototype,{initialize:function(t){r.initialize.apply(this,arguments),this._element=null,t&&(this.setElement(t.element),this._effect=a.FADE,this._firstStep=this._getStepInitial(),this.setConfig(t),this._currentElement=this._firstStep,this._stepsStack=[],this._updateInProgress=!1)},setConfig:function(t){i.tools.isUndefined(t)||(i.tools.isUndefined(t.element)||this.setElement(t.element),i.tools.isUndefined(t.effect)||this.setDynamicEffect(t.effect),i.tools.isUndefined(t.firstStep)||this.setFirstStep(t.firstStep))},setElement:function(t){i.tools.isUndefined(t)||(this._element=t)},setDynamicEffect:function(t){i.tools.isUndefined(t)||(this._effect=t)},setFirstStep:function(t){var e;i.tools.isUndefined(t)||(e=this._getStep(t),e.length>0&&(this._firstStep=e))},_updateSize:function(t){return},update:function(){},reset:function(){this.setStep(this._getStepFirst().attr("data-step"))},clearHeight:function(){this._element.css("height","")},clearStepsStack:function(){this._stepsStack.length=0,this._stepsStack=[]},showStep:function(t,e,n,s){if(this._isCurrentStep(t)||!this._isStepExist(t)||this.isUpdateInProgress())return void(n===!0&&i.tools.isFunction(e)&&e());var o,r=this,a=this._currentElement,l=a.attr("data-step"),u=this._getStep(t),c=a.height();this._updateInProgress=!0,s!==!0&&this._stepsStack.push(a.attr("data-step")),this._notify("fade-out-start",l,t),this._fadeOut(function(){r._notify("fade-out-end",l,t),r._setHeightNoTransition(c),r.setStep(t),o=u.height(),r._notify("resize-start",l,t),r._element.css("height",o),setTimeout(function(){r._notify("resize-end",l,t),r._notify("fade-in-start",l,t),r._fadeIn(function(){r._notify("fade-in-end",l,t),r._setHeightNoTransition(""),i.tools.isFunction(e)&&e(),r._updateInProgress=!1})},350)})},showPreviousStep:function(){var t=this._stepsStack.pop();i.tools.isUndefined(t)||this.showStep(t,function(){},!1,!0)},isStepsStackEmpty:function(){return 0===this._stepsStack.length},setStep:function(t){var e=this._getStep(t);e.length>0&&(this._element.find("> [data-step]").removeClass("visible"),e.addClass("visible"),this._currentElement=e)},_getStep:function(t){return this._element.find("> [data-step="+t+"]")},_getStepInitial:function(){var t;return t=this._element.find(".visible[data-step]"),t=t.length>0?t.eq(0):this._getStepFirst()},_getStepFirst:function(){return this._element.find("> [data-step]").eq(0)},_isStepExist:function(t){return this._element.find("> [data-step="+t+"]").length>0},isUpdateInProgress:function(){return this._updateInProgress},_isCurrentStep:function(t){return this._currentElement.attr("data-step")===t.toString()},showNext:function(){},showPrev:function(){},_fadeOut:function(t){this._unbindTransitionEnd(),this._bindTransitionEnd(t),this._element.attr("visible","false")},_fadeOut2:function(t){this._unbindTransitionEnd(),this._bindTransitionEnd(t),this._element.attr("visible","false")},_fadeIn:function(t){this._unbindTransitionEnd(),this._bindTransitionEnd(t),this._element.removeAttr("visible")},_unbindTransitionEnd:function(){this._element.unbindTransitionEnd()},_bindTransitionEnd:function(t){t=t||function(){},this._element.transitionEnd(function(){this._unbindTransitionEnd(),t(),this._notify("fade-in-end")}.bind(this))},collapse:function(){return this._fadeOut(function(){this._updateSize(0)}.bind(this))},getCurrentStepName:function(){return this._currentElement.attr("data-step")},_setHeightNoTransition:function(t){this._element.attr("data-no-transition","true"),this._triggerRender(),this._element.css("height",t),this._triggerRender(),this._element.removeAttr("data-no-transition")},_triggerRender:function(){this._element.get(0).offsetHeight}}),t(s)};s.define("dynamicContent",["extend","basePubSub"],o)}(this,this.document,this.BM,this.jQuery,this.modules,this.radio),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_cart_45_init_46_js__=function(){"use strict";return function(t,e){e.define("CartInit",["CartActions"],function(t,e){e.loadCart(),t()})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_client_45_data_45_init_46_js__=function(){"use strict";return function(t,e){e.define("ClientDataInit",[],function(t){BM.helper.brewingMethods.fetch(function(){}),BM.helper.grind.fetchTypes(function(){}),t()})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_global_45_styles_45_modifiers_45_init_46_js__=function(){"use strict";return function(t,e,i){e.define("InitGlobalStylesModifiers",[],function(t){var e=i(document.body);e.addClass(BM.tools.client.isTouch()?"m-touch":"m-desktop"),t()})}(this,this.modules,this.jQuery,this.radio),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_header_45_init_46_js__=function(){"use strict";return function(t,e,i){e.define("HeaderInit",["extend","baseView","CartStore"],function(t,e,n,s){var o=e(n),r=o,a=r.superclass;BM.tools.mixin(r.prototype,{initialize:function(){a.initialize.apply(this,arguments),this.el&&(this.$orderHeaderText=this.el.find("@bm-header-header-order-text"),this._bindEvents())},_bindEvents:function(){var t=this;s.addChangeListener(function(){t._onCartStoreChange()})},_onCartStoreChange:function(){if(BM.config.mainConfig.show_header_order){var t=s.getCart();this._setOrderHeaderVisible(t&&_.isArray(t.order_items)&&t.order_items.length>0)}},_setOrderHeaderVisible:function(t){t?(this.el.addClass("m-header-order-visible"),this._updateHeaderOrder()):this.el.removeClass("m-header-order-visible")},_updateHeaderOrder:function(){var t=s.getCart(),e=this.$orderHeaderText.data("order-header-text"),i=t.order_items.length,n=BM.helper.pluralize.getWordPack(i,2),o=t.total_amount;e=e.replace("%{count}",i),e=e.replace("%{wordPack}",n),e=e.replace("%{totalAmount}",o),this.$orderHeaderText.html(e)}}),new o({element:i("@bm-header")}),t(o)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_react_45_setup_46_js__=function(){"use strict";return function(t,e){e.define("ReactSetup",["CartConstants","CartActions","CartStore","StateConstants","StateActions","StateStore","OrderConstants","OrderActions","OrderStore"],function(t){t()})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_init_47_side_45_menu_45_init_46_js__=function(){"use strict";return function(t,e,i){e.define("SideMenuInit",[],function(){var t=i(document.body),e=i("@bm-side-menu-toggle-button");e.on(BM.helper.event.clickName(),function(){t.hasClass("m-side-menu-opened")?t.removeClass("m-side-menu-opened"):t.addClass("m-side-menu-opened")})})}(this,this.modules,this.jQuery,this.radio),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_brewing_45_method_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ItemBrewingMethodItem",["extend","baseView"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(t){r.initialize.apply(this,arguments),this.el&&(this.$text=this.el.find("@bm-brewing-method-item-text"),this._config=n.tools.mixin({},t),this.render())},render:function(){this._config.data&&(this.el.attr("data-name",this._config.data.name),this.el.attr("data-size",this._config.data.size||"normal"),this.$text.html(this._config.data.label))},_getTemplateName:function(){return"bm-brewing-method-item-template"}}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_form_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ItemFormOrder",["extend","baseView","ItemAddedItems","CartStore"],function(t,e,s,o,r){var a=e(s),l=a,u=l.superclass;n.tools.mixin(l.prototype,{initialize:function(){u.initialize.apply(this,arguments),this.el&&(this._amount=null,this._grind=null,this.$amountItems=this.el.find("@bm-item-form-order-amount-item"),this.$grindItems=this.el.find("@bm-item-form-order-grind-item"),this.$buttonAdd=this.el.find("@bm-item-form-order-button-add"),this.$addedItemsWrapper=this.el.find("@bm-item-form-order-added-items"),this.$orderButtonWrapper=this.el.find("@bm-item-form-order-order-button-wrapper"),this._updateAmount(),this._updateGrind(),this._updateButton(),this._renderAddedItems(),this._bindEvents())},_bindEvents:function(){var t=n.helper.event.clickName();this.$buttonAdd.on(t,function(t){this._onButtonAddClick(t)}.bind(this)),this.$amountItems.on(t,function(t){this._onAmountItemClick(t)}.bind(this)),this.$grindItems.on(t,function(t){this._onGrindItemClick(t)}.bind(this)),r.addChangeListener(function(){this._onCartStoreUpdate()}.bind(this))},_onButtonAddClick:function(){this._notifyAdd()},_onAmountItemClick:function(t){for(var e=i(t.target);e.filter("[role=bm-item-form-order-amount-item]").length<1;)e=e.parent();this.$amountItems.removeClass("m-selected"),e.addClass("m-selected"),this._updateButton(),this._updateAmount()},_onGrindItemClick:function(t){for(var e=i(t.target);e.filter("[role=bm-item-form-order-grind-item]").length<1;)e=e.parent();this.$grindItems.removeClass("m-selected"),this.$grindItems.removeClass("m-color-scheme-white"),e.addClass("m-selected"),e.addClass("m-color-scheme-white"),this._updateButton(),this._updateGrind()},_onCartStoreUpdate:function(){this._updateButtonOrder()},setPrices:function(t){t.forEach(function(t){var e=this.$amountItems.filter(function(){return i(this).data("amount")==t.amount}),n=e.find("@bm-item-form-order-amount-item-price");n.html(t.value+n.data("text"))}.bind(this))},_updateAmount:function(){this._amount=this._getSelectedItemAmount().data("amount")},_updateGrind:function(){this._grind=this.$grindItems.filter(".m-selected").last().data("grind")},_getSelectedItemAmount:function(){return this.$amountItems.filter(".m-selected").last()},_getSelectedItemGrind:function(){return this.$grindItems.filter(".m-selected").last()},_updateButton:function(){var t,e=this._getSelectedItemAmount().data("amount"),i=this._getSelectedItemGrind().find(".bm-brewing-method").data("config").grind;t=this.$buttonAdd.data("text-template"),t=t.replace("${amount}",e),t=t.replace("${grind}",i.label_full.toLowerCase()),this.$buttonAdd.html(t)},_updateButtonOrder:function(){var t=r.getCart();t&&_.isArray(t.order_items)&&t.order_items.length>0?this.$orderButtonWrapper.removeClass("m-hidden"):this.$orderButtonWrapper.addClass("m-hidden")},_renderAddedItems:function(){React.render(React.createElement("div",null,React.createElement(o,null)),this.$addedItemsWrapper.get(0))},_notifyAdd:function(){var t={amount:this._amount,grind:this._grind};this._notify("add",t)}}),t(a)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_form_95_old_46_js__=function(){"use strict";return function(t,e,i,n){e.define("FormItemOrderOld",["extend","baseView","FormItemSelectGrind","ButtonNumber"],function(t,e,i,s,o){var r=e(i),a=r,l=a.superclass;n.tools.mixin(a.prototype,{initialize:function(){l.initialize.apply(this,arguments),this.$elem&&(this._formSelectGrind=null,this._buttonNumber250=null,this._buttonNumber500=null,this._buttonNumber1kg=null,this.$elemFormSelectGrind=this.$elem.find("@bm-form-select-grind"),this.$elemButtonNumber250=this.$elem.find("@bm-button-number-250"),this.$elemButtonNumber500=this.$elem.find("@bm-button-number-500"),this.$elemButtonNumber1kg=this.$elem.find("@bm-button-number-1kg"),this._initFormSelectGrind(),this._initButtonsNumber())},_initFormSelectGrind:function(){n.tools.isNull(this._formSelectGrind)&&(this._formSelectGrind=new s({element:this.$elemFormSelectGrind}),this._formSelectGrind.on("change",function(t){this._onFormSelectGrindChange(t)}.bind(this)))},_initButtonsNumber:function(){n.tools.isNull(this._buttonNumber250)&&(this._buttonNumber250=new o({element:this.$elemButtonNumber250}),this._buttonNumber250.on("change",function(t){this._onButtonNumberChange("250",t)}.bind(this))),n.tools.isNull(this._buttonNumber500)&&(this._buttonNumber500=new o({element:this.$elemButtonNumber500}),this._buttonNumber500.on("change",function(t){this._onButtonNumberChange("500",t)}.bind(this))),n.tools.isNull(this._buttonNumber1kg)&&(this._buttonNumber1kg=new o({element:this.$elemButtonNumber1kg}),this._buttonNumber1kg.on("change",function(t){this._onButtonNumberChange("1kg",t)}.bind(this)))},_onFormSelectGrindChange:function(){},_onButtonNumberChange:function(t,e){console.log(t,e)}}),t(r)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("Item",["extend","baseView","ItemModel","ItemFormOrder","ItemSpecsItem","ItemBrewingMethodItem","CartActions","StateActions"],function(t,e,i,s,o,r,a,l){var u=e(i),c=u,m=c.superclass;n.tools.mixin(c.prototype,{initialize:function(t){m.initialize.apply(this,arguments),this.$elem&&(this._config=n.tools.mixin({},t),this._item=new s({data:this._config.data}),this._formOrder=null,this.$elemFormOrder=this.$elem.find("@bm-item-form-order"),this.$name=this.el.find("@bm-item-name"),this.$descriptionShort=this.el.find("@bm-item-description-short"),this.$rating=this.el.find("@bm-item-rating"),this.$price=this.el.find("@bm-item-price"),this.$specsWrapper=this.el.find("@bm-item-specs"),this.$description=this.el.find("@bm-item-description"),this.$imageWrapper=this.el.find("@bm-item-image-wrapper"),this.$image=this.el.find("@bm-item-image"),this.$imagePlantation=this.el.find("@bm-item-image-plantation"),this.$methodsWrapper=this.el.find("@bm-item-methods-wrapper"),this._timeoutZoom=null,this._specs=[],this._methods=[],this._initFormOrder(),this._updateFormOrder(),this._bindEvents(),this.render())},_bindEvents:function(){n.tools.client.isTouch()?this.$imageWrapper.on("tap",function(){this._onImageWrapperTap()}.bind(this)):(this.$imageWrapper.on("mouseover",function(){this._onImageWrapperMouseOver()}.bind(this)),this.$imageWrapper.on("mouseout",function(){this._onImageWrapperMouseOut()}.bind(this)))},_onImageWrapperTap:function(){this._toggleZoom()},_onImageWrapperMouseOver:function(){this._isZoomVisible()||(this._clearTimeoutZoom(),this._timeoutZoom=setTimeout(function(){this._showZoom()}.bind(this),300))},_onImageWrapperMouseOut:function(){this._clearTimeoutZoom(),this._hideZoom()},_clearTimeoutZoom:function(){n.tools.isNull(this._timeoutZoom)||(clearTimeout(this._timeoutZoom),this._timeoutZoom=null)},_toggleZoom:function(){this._isZoomVisible()?this._hideZoom():this._showZoom()},_showZoom:function(){this.el.addClass("m-scale-visible")},_hideZoom:function(){this.el.removeClass("m-scale-visible")},_isZoomVisible:function(){return this.el.hasClass("m-scale-visible")},render:function(){this._config.data&&(this.$name.html(this._config.data.name),this.$descriptionShort.html(this._config.data.descriptionShort),this.$rating.attr("data-value",this._config.data.rating),this.$price.html(this._item.getPrice250()),this.$description.html(this._config.data.description),this.$image.attr("src",this._config.data.image.large),this.$imagePlantation.attr("src",this._config.data.imagePlantation.default),this._renderSpecs(),this._renderBrewingMethods())},_renderSpecs:function(){this._specs.forEach(function(t){t.destroy()}),this._specs.length=0,this._specs=[],this.$specsWrapper.html(""),this._config.data.specsWithLabels.forEach(function(t){var e=new r({data:t,options:{hint:!0}});this.$specsWrapper.append(e.getElement())}.bind(this))},_renderBrewingMethods:function(){this._methods.forEach(function(t){t.destroy()}),this._methods.length=0,this._methods=[],this.$methodsWrapper.html(""),this._config.data.methodsWithLabels.forEach(function(t){var e=new a({data:t});this.$methodsWrapper.append(e.getElement())}.bind(this))},_initFormOrder:function(){var t=this;n.tools.isNull(this._formOrder)&&(this._formOrder=new o({element:this.$elemFormOrder}),this._formOrder.on("add",function(e){t._addItemToCart(e)}))},_addItemToCart:function(t){l.addItem(this._config.data.id,t.amount,t.grind)},_updateFormOrder:function(){this._formOrder.setPrices(this._item.getData().price)},_getTemplateName:function(){return"bm-item-template"}}),t(u)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_specs_45_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ItemSpecsItem",["extend","baseView"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(t){r.initialize.apply(this,arguments),this.el&&(this.$label=this.el.find("@bm-item-specs-item-label"),this.$value=this.el.find("@bm-item-specs-item-value"),this.$hint=this.el.find("@bm-item-specs-item-hint"),this._timeoutShowHint=null,this._config=n.tools.mixin({},t),this._bindEvents(),this.render())},_bindEvents:function(){n.tools.client.isTouch()?this._onLabelTap():(this.$label.on("mouseover",function(){this._onLabelMouseOver()}.bind(this)),this.$label.on("mouseout",function(){this._onLabelMouseOut()}.bind(this)))},_onLabelMouseOver:function(){this._isHintAvailable()&&(this._timeoutShowHint=setTimeout(function(){this._showHint()}.bind(this),300))},_onLabelMouseOut:function(){n.tools.isNull(this._timeoutShowHint)||(clearTimeout(this._timeoutShowHint),this._timeoutShowHint=null),this._hideHint()},_onLabelTap:function(){this._isHintAvailable()&&this.$label.on("tap",function(){this._toggleHint()}.bind(this))},_toggleHint:function(){this._isHintVisible()?this._hideHint():this._showHint()},_showHint:function(){this.el.addClass("m-hint-visible")},_hideHint:function(){this.el.removeClass("m-hint-visible")},_isHintVisible:function(){return this.el.hasClass("m-hint-visible")},_isHintAvailable:function(){return this._config&&this._config.data.description&&this._config.options&&this._config.options.hint===!0},render:function(){this._config.data&&(this.el.attr("data-name",this._config.data.name),this.$label.html(this._config.data.label),this.$value.attr("data-value",this._config.data.value),this.$hint.html(this._config.data.description),this._isHintAvailable()&&this.el.addClass("m-hint-available"))},_getTemplateName:function(){return"bm-item-specs-all-item-template"}}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_order_47_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("OrderItem",["extend","baseView"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(){r.initialize.apply(this,arguments),!this.el},_getTemplateName:function(){return"bm-order-item-template"}}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_popup_47_popup_45_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("PopupItem",["extend","popupBaseClass","dynamicContent","Item","StateActions"],function(t,e,i,s,o,r){var a=e(i),l=a,u=l.superclass;n.tools.mixin(l.prototype,{initialize:function(t){u.initialize.call(this,{rootClassName:["m-version-2","bm-popup-item"],useTemplate:!0}),this._config=n.tools.mixin({},t),this._dynamicContent=null,this._itemHandler=null,this.$elemDynamicContent=this.$elem.find("@bm-dynamic-content"),this.$elemContent=this.$elem.find("@bm-popup-item-content"),this.$elemButtonClose=this.$elem.find("@bm-popup-item-button-close"),this._initDynamicContent(),this._bindEvents(),this._initItem()},_bindEvents:function(){this.$elemButtonClose.on(n.helper.event.clickName(),function(){this._onButtonCloseClick()}.bind(this))},_onButtonCloseClick:function(){this.hide()},_initDynamicContent:function(){n.tools.isNull(this._dynamicContent)&&(this._dynamicContent=new s({element:this.$elemDynamicContent}),this._dynamicContent.setStep("content"))},_initItem:function(){n.tools.isNull(this._itemHandler)&&(this._itemHandler=new o({data:this._config.data}),this.$elemContent.append(this._itemHandler.getElement()))},show:function(){r.setViewingItem(this._config.data),u.show.apply(this,arguments)},hide:function(){r.setViewingItem(null),u.hide.apply(this,arguments)},_getTemplateName:function(){return"bm-popup-item-template"}}),t(a)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_transform_45_origin_45_dependent_47_transform_45_origin_45_dependent_46_js__=function(){"use strict";return function(t,e,i){e.define("initTransformOriginDependentElements",["extend","baseClass"],function(t,e,n){var s=function(t){function e(){$traceurRuntime.superConstructor(e).apply(this,arguments)}return $traceurRuntime.createClass(e,{initialize:function(){$traceurRuntime.superGet(this,e.prototype,"initialize").apply(this,arguments),this.$elements=i(".j-transform-origin-dependent"),i.each(this.$elements,function(t,e){var n=i(e),s=n.offset(),o=n.width();n.on("mouseover mousemove",function(t){var e,i;t.pageX&&(e=t.pageX-s.left,i=100*(e/o).toFixed(1),i=0>i?0:i,n.attr("data-transform-origin",i))}),n.on("mouseout",function(){n.removeAttr("style")})})}},{},t)}(n);new s,t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__react_47_components_47_PageOrder_47_OrderSummarySimple_46_js__=function(){"use strict";return function(t,e){e.define("OrderSummarySimple",["CartActions","CartStore","OrderSummarySimpleItem"],function(t,e,i,n){var s=React.createClass({displayName:"OrderSummary",propTypes:{cart:React.PropTypes.object},getGroups:function(){var t={mono:[],aroma:[],espresso:[],exotic:[]},e=[];return this.props.cart.order_items.forEach(function(e){t[e.item.kind].push(e)}),Object.keys(t).forEach(function(i){t[i].length>0&&e.push({kind:i,objects:t[i]})}),e},render:function(){if(!this.props.cart)return null;var t=this.getGroups();return React.createElement("div",{className:"bm-page-order-summary"},t.map(function(t){return React.createElement("div",{className:"bm-page-order-summary-group"},React.createElement("div",{className:"bm-page-order-summary-subheader m-"+t.kind},React.createElement("div",{className:"bm-page-order-summary-subheader-icon"}),React.createElement("div",{className:"bm-page-order-summary-subheader-text"},BM.helper.coffeeKinds.getWordByKind(t.kind))),React.createElement("div",{className:"bm-page-order-summary-items-wrapper"},t.objects.map(function(t,e){return React.createElement(n,React.__spread({},t,{counter:e+1}))})))}))}});t(s)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_components_47_PageOrder_47_OrderSummarySimpleItem_46_js__=function(){"use strict";return function(t,e){e.define("OrderSummarySimpleItem",["CartActions","CartStore"],function(t,e){var i=React.createClass({displayName:"OrderSummary",propTypes:{item:React.PropTypes.object,weight:React.PropTypes.number,quantity:React.PropTypes.number,grind:React.PropTypes.string,counter:React.PropTypes.number},handleAddItemClick:function(){e.addItem(this.props.item.id,this.props.weight,this.props.grind)},handleRemoveItemClick:function(){e.removeItem(this.props.item.id,this.props.weight,this.props.grind)},handleDeleteItemClick:function(){e.deleteItem(this.props.item.id,this.props.weight,this.props.grind)},getTotalPriceForItem:function(){var t=this.props,e=t.item,i=t.weight,n=t.quantity,s=250===i?e.price:e["price_"+i];return n*s},render:function(){var t=this.props.item.name,e=this.props.weight,i=this.props.quantity,n=this.props.grind,s=BM.helper.pluralize.getWordPack(i);return React.createElement("div",{className:"bm-page-order-summary-item-simple"},React.createElement("div",{className:"bm-page-order-summary-item-simple-counter"},this.props.counter),React.createElement("div",{className:"bm-page-order-summary-item-simple-content"},React.createElement("div",{className:"bm-page-order-summary-item-simple-content-text"},"«",t,"», ",e," грамм, ",BM.helper.grind.getGrindTextFull(n).toLowerCase(),", ",i," ",s),React.createElement("div",{className:"bm-page-order-summary-item-simple-content-aside"},React.createElement("div",{className:"bm-page-order-summary-item-simple-content-aside-content"},React.createElement("div",{className:"bm-page-order-summary-item-simple-content-aside-content-text"},this.getTotalPriceForItem()," руб."))),React.createElement("div",{className:"bm-page-order-summary-item-simple-side-controls"},React.createElement("div",{className:"buttons-wrapper"},React.createElement("div",{className:"button m-minus",onClick:this.handleRemoveItemClick}),React.createElement("div",{className:"button m-plus",onClick:this.handleAddItemClick}),React.createElement("div",{className:"button m-delete",onClick:this.handleDeleteItemClick})))))}});t(i)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__react_47_components_47_PageOrder_47_OrderSummaryTable_46_js__=function(){"use strict";return function(t,e){e.define("OrderSummaryTable",["CartActions","CartStore"],function(t){var e=React.createClass({displayName:"OrderSummary",propTypes:{cart:React.PropTypes.object},getGroups:function(){var t={mono:[],aroma:[],espresso:[],exotic:[]},e=[];return this.props.cart.order_items.forEach(function(e){t[e.item.kind].push(e)}),Object.keys(t).forEach(function(i){t[i].length>0&&e.push({kind:i,objects:t[i]})}),e},render:function(){if(!this.props.cart)return null;this.getGroups();return React.createElement("div",{className:"bm-page-order-summary-table"},React.createElement("div",{className:"bm-page-order-summary-table-row m-header"},React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Название"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Вес"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Помол"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Количоство"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Сумма")),React.createElement("div",{className:"bm-page-order-summary-table-row"},React.createElement("div",{className:"bm-page-order-summary-table-cell"},"Классический сорт «Никарагуа марагоджиб»"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"250г"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"В зерне"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"1 уп"),React.createElement("div",{className:"bm-page-order-summary-table-cell"},"400 руб"),React.createElement("div",{className:"bm-page-order-summary-table-row-aside"},React.createElement("span",{className:"bm-page-order-summary-table-remove-item"},"удалить"))))}});t(e)})}(this,this.modules,this.jQuery),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_form_47_grind_95_old_46_js__=function(){"use strict";return function(t,e,i,n){e.define("FormItemSelectGrindOld",["extend","baseView"],function(e,s,o){var r=s(o),a=r,l=a.superclass;n.tools.mixin(a.prototype,{initialize:function(){l.initialize.apply(this,arguments),this.$elem&&(this.$elemsWithUniqueId=this.$elem.find("@bm-form-unique-element"),this.$elemsOptionsViaGrind=this.$elem.find("@bm-form-grind-option-via-grind"),this.$elemsBrewingMethods=this.$elem.find("@bm-brewing-method-item"),this.$elemViaTypeWrapper=this.$elem.find("@bm-form-select-grind-via-type-wrapper"),this._setUniqueIds(),this._bindEvents(),t.o=this)},_bindEvents:function(){this.$elemsOptionsViaGrind.on("change",function(t){this._onOptionViaGrindChange(t)}.bind(this)),this.$elemsBrewingMethods.on(n.helper.event.clickName(),function(t){this._onBrewingMethodClick(t)}.bind(this))},_onOptionViaGrindChange:function(){this._setSelectViaGrindStateBlur(!1),this._unselectViaMethodItems(),this._notify("change",this.$elemsOptionsViaGrind.filter(":checked").val())},_onBrewingMethodClick:function(t){var e=i(t.target);e.hasClass("bm-brewing-method")||(e=e.parent()),e.addClass("m-selected"),this.$elemsBrewingMethods.not(e).removeClass("m-selected"),this._setSelectViaGrindStateBlur(!0),this.$elemsOptionsViaGrind.val([]),this._notify("change",e.data("name"))},_setUniqueIds:function(){var t=this.getInstanceId();this.$elemsWithUniqueId.each(function(){var e=i(this);"LABEL"===e.prop("tagName")?e.attr("for",e.attr("for")+"-"+t):"INPUT"===e.prop("tagName")&&(e.attr("id",e.attr("id")+"-"+t),e.attr("name",e.attr("name")+"-"+t))})},_setSelectViaGrindStateBlur:function(t){t?this.$elemViaTypeWrapper.addClass("m-blur"):this.$elemViaTypeWrapper.removeClass("m-blur")},_unselectViaMethodItems:function(){this.$elemsBrewingMethods.removeClass("m-selected")}}),e(r)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__ui_45_modules_47_item_47_form_47_selected_45_item_46_js__=function(){"use strict";return function(t,e,i,n){e.define("ItemFormOrderSelectedItem",["extend","baseView"],function(t,e,i){var s=e(i),o=s,r=o.superclass;n.tools.mixin(o.prototype,{initialize:function(){r.initialize.call(this,{useTemplate:!0}),this.el&&this._bindEvents()},_bindEvents:function(){n.helper.event.clickName()},_getTemplateName:function(){return"bm-item-form-order-selected-item"}}),t(s)})}(this,this.modules,this.jQuery,this.BM),{}}.call(Reflect.global),$__loadScriptsConfig_46_js__=function(){"use strict";return function(t,e,i,n){{var s=n.config||{},o=e.body.getAttribute("data-config"),r=JSON.parse(o)||{};r.assetHost||""}s.loadScriptsConfig={"default":function(){i.require("ui-modules")},"catalogue-index":function(){i.require("ui-modules"),i.require("CatalogueInit")},"order-index":function(){i.require("ui-modules"),i.require("OrderInit")}}}(this,this.document,this.modules,this.BM=this.BM||{}),{}}.call(Reflect.global),$__loadScripts_46_js__=function(){"use strict";return function(t,e,i){var n=i.tools=i.tools||{},s=i.config=i.config||{},o=function(t){var e=s.loadScriptsConfig;e.hasOwnProperty(t)?e[t]():e["default"]()};n.loadScripts=o}(this,this.document,this.BM=this.BM||{}),{}}.call(Reflect.global),$__initApp_46_js__=function(){"use strict";return function(t,e,i,n){var s=i.tools=i.tools||{},o=i.config=i.config||{},r=e.body.getAttribute("data-scripts"),a=r||o.mainConfig.action+"-"+o.mainConfig.scriptTemplate;console.enable(),n(function(){s.loadScripts(a)})}(this,this.document,this.BM||{},this.jQuery),{}}.call(Reflect.global);
//# sourceMappingURL=maps/modules.js.map